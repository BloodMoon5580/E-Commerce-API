<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Dashboard</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        body { 
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; 
            background: linear-gradient(to right, #f0f4f8, #e3e9ef); 
            color: #333; 
            padding: 20px; 
            margin: 0; 
        }
        h1 { 
            color: #0056b3; 
            text-align: center; 
            margin-bottom: 30px; 
            font-size: 2.5em; 
            text-shadow: 1px 1px 3px rgba(0, 0, 0, 0.1);
        }
        #log { 
            margin-top: 20px; 
            border: 1px solid #ccc; 
            background: white; 
            border-radius: 10px; 
            max-height: 300px; 
            overflow-y: auto; 
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
            padding: 15px; 
        }
        .alert { 
            color: #d9534f; 
            font-weight: bold; 
            padding: 12px; 
            border: 1px solid #f5c6cb; 
            border-radius: 5px; 
            margin: 10px 0; 
            background: rgba(217, 83, 79, 0.1);
            transition: all 0.3s ease;
        }
        .alert:hover { 
            background: rgba(217, 83, 79, 0.2);
        }
        .timestamp { 
            color: #999; 
            font-size: 0.85em; 
            display: block; 
            margin-top: 5px; 
        }
        .defamation { 
            font-style: italic; 
            color: #dc3545; 
        }
        .username { 
            font-weight: bold; 
            color: #0056b3; 
        }
        #chartContainer {
            margin-top: 30px;
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
        }
        #timeframeSelector {
            margin-bottom: 15px;
            padding: 10px;
            border: 1px solid #ccc;
            border-radius: 5px;
            background-color: #f8f9fa;
            color: #333;
            font-size: 1em;
            width: 200px;
            cursor: pointer;
        }
        canvas {
            border-radius: 10px;
            background: rgba(255, 255, 255, 0.9);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
        }
        @media (max-width: 600px) {
            h1 {
                font-size: 2em;
            }
            #timeframeSelector {
                width: 100%;
            }
        }
    </style>
</head>
<body>
    <h1>Admin Dashboard</h1>
    <div id="log" aria-live="polite"></div>

    <div id="chartContainer">
        <select id="timeframeSelector">
            <option value="thisWeek">This Week</option>
            <option value="pastWeeks" style="display:none;">Past Weeks</option>
            <option value="pastMonths" style="display:none;">Past Months</option>
            <option value="pastSixMonths" style="display:none;">Past 6 Months</option>
            <option value="pastYears" style="display:none;">Past Years</option>
        </select>
        <canvas id="barChart"></canvas>
    </div>

    <script>
        let userAttempts = {};
        let totalDefamatoryReviews = 0;
        let historicalData = {
            weekly: { logins: Array(7).fill(0), reviews: Array(7).fill(0) },
            monthly: { logins: [], reviews: [] },
            yearly: { logins: [], reviews: [] }
        };

        function logAlert(message) {
            const timestamp = new Date().toLocaleString();
            const logDiv = document.createElement('div');
            logDiv.className = 'alert';
            logDiv.innerHTML = `${message} <span class="timestamp">${timestamp}</span>`;
            document.getElementById('log').appendChild(logDiv);
        }

        function simulateLoginAttempt(username) {
            if (!userAttempts[username]) {
                userAttempts[username] = 0;
            }

            if (userAttempts[username] < 3) {
                userAttempts[username]++;
                logAlert(`User ${username} has failed CAPTCHA attempt #${userAttempts[username]}.`);

                if (userAttempts[username] >= 3) {
                    logAlert(`Critical Alert! User ${username} has reached the maximum login attempts and can no longer attempt.`);
                }
            }
        }

        const users = ['User123', 'User456', 'User789', 'User101'];
        const captchaInterval = setInterval(() => {
            const randomUser = users[Math.floor(Math.random() * users.length)];
            simulateLoginAttempt(randomUser);
        }, 10000);

        setInterval(() => {
            const reviews = [
                { username: 'User123', text: 'This site is a scam!' },
                { username: 'User456', text: 'I had a terrible experience, do not use!' },
                { username: 'User789', text: 'Great service!' },
                { username: 'User101', text: 'Very untrustworthy company.' }
            ];
            const review = reviews[Math.floor(Math.random() * reviews.length)];
            if (review.text.includes('scam') || review.text.includes('terrible') || review.text.includes('untrustworthy')) {
                logAlert(`Alert! Defamatory review detected from <span class="username">${review.username}</span>: <span class="defamation">"${review.text}"</span>`);
                totalDefamatoryReviews++;
            }
        }, 15000);

        function updateHistoricalData() {
            const totalFailedLogins = Object.values(userAttempts).reduce((acc, attempts) => acc + attempts, 0);
            const today = new Date();
            const dayOfWeek = today.getDay();

            historicalData.weekly.logins[dayOfWeek] += totalFailedLogins;
            historicalData.weekly.reviews[dayOfWeek] += totalDefamatoryReviews;
        }

        const ctx = document.getElementById('barChart').getContext('2d');
        const barChart = new Chart(ctx, {
            type: 'bar',
            data: {
                labels: [],
                datasets: [
                    {
                        label: 'Failed Logins',
                        data: [],
                        backgroundColor: 'rgba(255, 99, 132, 0.9)',
                    }, 
                    {
                        label: 'Defamatory Reviews',
                        data: [],
                        backgroundColor: 'rgba(54, 162, 235, 0.9)',
                    }
                ]
            },
            options: {
                scales: {
                    y: {
                        beginAtZero: true,
                        title: {
                            display: true,
                            text: 'Count',
                            color: '#666'
                        }
                    },
                    x: {
                        title: {
                            display: true,
                            text: 'Date',
                            color: '#666'
                        }
                    }
                },
                plugins: {
                    legend: {
                        labels: {
                            color: '#343a40'
                        }
                    }
                }
            }
        });

        function getWeekDates() {
            const dates = [];
            const today = new Date();
            for (let i = 0; i < 7; i++) {
                const date = new Date(today);
                date.setDate(today.getDate() - (today.getDay() - i));
                dates.push(date.toLocaleDateString());
            }
            return dates.reverse();
        }

        function updateChart() {
            const timeframe = document.getElementById('timeframeSelector').value;

            if (timeframe === 'thisWeek') {
                barChart.data.labels = getWeekDates();
                barChart.data.datasets[0].data = historicalData.weekly.logins;
                barChart.data.datasets[1].data = historicalData.weekly.reviews;
            }

            barChart.update();
        }

        document.getElementById('timeframeSelector').addEventListener('change', function() {
            const selectedValue = this.value;
            const options = document.querySelectorAll('#timeframeSelector option');

            options.forEach(option => {
                if (option.value !== 'thisWeek') {
                    option.style.display = selectedValue === 'thisWeek' ? 'block' : 'none';
                }
            });

            updateChart();
        });

        setInterval(() => {
            updateHistoricalData();
            updateChart();
        }, 15000);
    </script>
</body>
</html>
